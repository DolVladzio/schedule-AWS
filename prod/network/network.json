{
	"aws_region": "eu-central-1",

	"vpc": [
		{
			"name": "main-vpc",
			"vpc_cidr_block": "10.1.0.0/16",
			"subnets": [
				{
					"name": "vpc-subnet",
					"cidr_block": "10.1.1.0/24",
					"public": true,
					"zone": "a"
				},
				{
					"name": "vpc-private-subnet",
					"cidr_block": "10.1.2.0/24",
					"public": false,
					"zone": "a"
				},
				{
					"name": "vpc-private-subnet-2",
					"cidr_block": "10.1.3.0/24",
					"public": false,
					"zone": "a"
				}
			]
		}
	],
	"security_groups": [
		{
			"name": "db-sg",
			"vpc_name": "main-vpc",
			"description": "Bastion accessible only from cluster",
			"ingress": [
				{
					"port": 5432,
					"protocol": "tcp",
					"attach_to": "maindb"
				}
			],
			"egress": [
				{
					"protocol": "tcp",
					"port": 80,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				},
				{
					"protocol": "tcp",
					"port": 443,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				},
				{
					"protocol": "udp",
					"port": 53,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				}
			]
		},			
		{
			"name": "bastion-sg",
			"vpc_name": "main-vpc",
			"description": "Allow SSH from admin IP to private network",
			"ingress": [
				{
					"port": 22,
					"protocol": "tcp",
					"attach_to": "bastion"
				}
			],
			"egress": [
				{
					"protocol": "tcp",
					"port": 22,
					"destination": {
						"dev": "dev-k3s-sg",
						"prod": "k3s-sg"
					}
				},
				{
					"protocol": "tcp",
					"port": 22,
					"destination": {
						"dev": "dev-db-sg",
						"prod": "db-sg"
					}
				},
				{
					"protocol": "tcp",
					"port": 80,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				},
				{
					"protocol": "tcp",
					"port": 443,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				},
				{
					"protocol": "udp",
					"port": 53,
					"destination": {
						"dev": "public",
						"prod": "public"
					}
				}
			]
		}
	]
}